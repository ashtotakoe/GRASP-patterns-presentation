(()=>{"use strict";var e={8099:(e,t,n)=>{n.d(t,{Z:()=>w});var a=n(8081),r=n.n(a),s=n(3645),i=n.n(s),o=n(1667),c=n.n(o),l=new URL(n(5763),n.b),u=new URL(n(1064),n.b),d=new URL(n(1515),n.b),p=i()(r()),m=c()(l),h=c()(u),g=c()(d);p.push([e.id,".not-found{height:51vh;color:#f4f5f6}.not-found__heading{margin:auto;margin-top:200px;font-size:3rem;text-align:center}.footer{width:100%;margin-top:40px}.footer .container{display:flex;align-items:center;justify-content:center;margin:30px;color:#f4f5f6}.footer .container__github{margin-right:auto;color:#f4f5f6}.footer .container__rss-logo{width:100px;height:37px;margin-left:auto;background:url("+m+") center/cover no-repeat}.header{width:100%;color:#f4f5f6}.header>*{display:inline-block;margin:15px}.popup{position:fixed;z-index:1;top:0;right:0;width:100vw;height:100vh;visibility:hidden;transition:visibility .3s ease}.popup__message{width:235px;min-height:30px;margin:auto;margin-top:200px;font-size:1.5rem;text-align:center;background-color:#f4f5f6;border:5px solid #181726;border-radius:5%}.popup.active{visibility:visible}.car-input{display:flex;align-items:center;justify-content:space-between;width:190px}.car-input__name{width:80px;height:18px}.car-input__color{height:24px}.pagination{display:flex;justify-content:center}.pagination__button{margin:5px;padding:5px}.car{margin-top:5px}.car__model{width:50px;height:25px;margin-top:3px;background:url("+h+") center/cover no-repeat}.garage{margin:15px;color:#f4f5f6}.garage__cars-wrapper{margin-top:35px}.car-cell{position:relative;height:100px;margin:5px;padding:5px;color:#181726;background:#f4f5f6}.car-cell__controls{display:flex;justify-content:space-between;width:30px;margin-top:5px}.car-cell__road{height:2px;margin-top:33px;background:#181726}.car-cell__button{margin:0 3px;padding:0 7px}.car-cell__car{position:absolute}.car-cell__flag{position:absolute;z-index:1;right:68px;bottom:11px;width:18px;height:20px;background:url("+g+") center/cover no-repeat}.garage-control{width:230px;height:80px;margin:10px;background-color:#f4f5f6}.garage-control__container{width:83%;margin:auto;padding-top:5px}.garage-control__controls-wrapper{display:flex;justify-content:space-between;height:15px;margin:5px}.garage-control__button{width:70px;height:20px}.winners{margin:15px;color:#f4f5f6}.winners-leader-board{min-height:600px;margin:30px;padding:30px 0;font-size:3rem;color:#f4f5f6;text-align:center;border-bottom:1px solid #f4f5f6}.winners-leader-board .headers-row{display:flex;justify-content:space-between}.winners-leader-board .headers-row__header{width:100px;font-size:1.2rem}.winner-cell{display:flex;justify-content:space-between;margin-top:15px}.winner-cell__data{width:100px;font-size:1.2rem}.winner-cell .car{position:relative;width:100px}.winner-cell .car .icon{transform:translateY(-15px)}.winners-controls{display:flex;gap:15px;justify-content:center;margin-top:40px}.winners-controls__button{padding:0 5px}*{margin:0;padding:0}body{background-color:#181726}.root{display:flex;flex-direction:column;justify-content:space-between}.icon{transform:translateY(-9px);width:50px;height:50px}",""]);const w=p},3645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",a=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),a&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),a&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,a,r,s){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(a)for(var o=0;o<this.length;o++){var c=this[o][0];null!=c&&(i[c]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);a&&i[u[0]]||(void 0!==s&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=s),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),t.push(u))}},t}},1667:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},8081:e=>{e.exports=function(e){return e[1]}},4273:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var a=n(3379),r=n.n(a),s=n(7795),i=n.n(s),o=n(569),c=n.n(o),l=n(3565),u=n.n(l),d=n(9216),p=n.n(d),m=n(4589),h=n.n(m),g=n(8099),w={};w.styleTagTransform=h(),w.setAttributes=u(),w.insert=c().bind(null,"head"),w.domAPI=i(),w.insertStyleElement=p(),r()(g.Z,w);const b=g.Z&&g.Z.locals?g.Z.locals:void 0},3379:e=>{var t=[];function n(e){for(var n=-1,a=0;a<t.length;a++)if(t[a].identifier===e){n=a;break}return n}function a(e,a){for(var s={},i=[],o=0;o<e.length;o++){var c=e[o],l=a.base?c[0]+a.base:c[0],u=s[l]||0,d="".concat(l," ").concat(u);s[l]=u+1;var p=n(d),m={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)t[p].references++,t[p].updater(m);else{var h=r(m,a);a.byIndex=o,t.splice(o,0,{identifier:d,updater:h,references:1})}i.push(d)}return i}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var s=a(e=e||[],r=r||{});return function(e){e=e||[];for(var i=0;i<s.length;i++){var o=n(s[i]);t[o].references--}for(var c=a(e,r),l=0;l<s.length;l++){var u=n(s[l]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}s=c}}},569:e=>{var t={};e.exports=function(e,n){var a=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}},9216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var a="";n.supports&&(a+="@supports (".concat(n.supports,") {")),n.media&&(a+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(a+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),a+=n.css,r&&(a+="}"),n.media&&(a+="}"),n.supports&&(a+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(a,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},9962:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const a=n(1323),r=n(8785);(new class{root=new r.BaseComponent({tag:"div",parent:document.body,attribute:{className:"root"}});init(){(new a.Layout).init(this.root.element)}}).init()},4362:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.headersForPostMethod=void 0,t.headersForPostMethod={"Content-Type":"application/json"}},8348:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Footer=void 0;const a=n(8785);class r extends a.BaseComponent{constructor(e){super({tag:"footer",parent:e,attribute:{className:"footer",innerHTML:'\n          <div class="container">\n            <a class = "container__github" target= "_blank" href="https://github.com/ashtotakoe">github</a>\n            <h2 class = "container__author">Â© ashtotakoe 2023</h2>\n            <a class = "container__rss-logo" target= "_blank" href="https://rs.school/js/"></a>\n          </div>\n    '}})}}t.Footer=r},6675:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const a=n(8785);class r extends a.BaseComponent{heading=new a.BaseComponent({tag:"h1",parent:this.element,attribute:{className:"header__heading",textContent:"Async Race"}});navigation=new a.BaseComponent({tag:"nav",parent:this.element,attribute:{className:"header__navigation"}});garageButton=new a.BaseComponent({tag:"button",parent:this.navigation.element,attribute:{className:"header__navigation-button",innerHTML:"Garage"}});winnersButton=new a.BaseComponent({tag:"button",parent:this.navigation.element,attribute:{className:"header__navigation-button",innerHTML:"Winners"}});constructor(e){super({tag:"header",parent:e,attribute:{className:"header"}}),this.garageButton.element.addEventListener("click",this.navigationHandler),this.winnersButton.element.addEventListener("click",this.navigationHandler)}navigationHandler({target:e}){e&&e instanceof HTMLElement&&e.textContent&&Object.assign(window.location,{hash:e.textContent.toLowerCase()})}}t.Header=r},1323:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Layout=void 0;const a=n(8785),r=n(4655),s=n(1774),i=n(4872),o=n(6675),c=n(8348),l=n(774),u=n(475);t.Layout=class{init(e){const t=new s.Garage,n={"":t,"#garage":t,"#winners":new i.Winners,"#not-found":new l.NotFound},d=new o.Header(e),p=new a.BaseComponent({tag:"main",parent:e,attribute:{className:"main"}}),m=new a.BaseComponent({tag:"div",parent:p.element,attribute:{className:"router-element"}});return{header:d,popup:new u.Popup(p.element),router:new r.Router(n,m.element),footer:new c.Footer(e)}}}},774:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NotFound=void 0;const a=n(8785);class r extends a.BaseComponent{heading=new a.BaseComponent({tag:"h3",parent:this.element,attribute:{className:"not-found__heading",textContent:"page was not found"}});constructor(){super({tag:"div",attribute:{className:"not-found"}})}}t.NotFound=r},475:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Popup=void 0;const a=n(8785),r=n(6349);class s extends a.BaseComponent{messageHolder=new a.BaseComponent({tag:"div",parent:this.element,attribute:{className:"popup__message"}});constructor(e){super({tag:"div",parent:e,attribute:{className:"popup"}}),r.emitter.subscribe("show popup",(e=>this.showPopup(e)))}showPopup(e){Object.assign(this.messageHolder.element,{textContent:e}),this.element.classList.add("active"),setTimeout((()=>{this.element.classList.remove("active")}),4e3)}}t.Popup=s},3428:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.API=void 0,(n=t.API||(t.API={})).Path="http://127.0.0.1:3000",n[n.CarLimit=7]="CarLimit"},6306:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.HTTPMethods=void 0,(n=t.HTTPMethods||(t.HTTPMethods={})).GET="GET",n.POST="POST",n.PUT="PUT",n.DELETE="DELETE",n.PATCH="PATCH"},3234:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PageLimits=void 0,(n=t.PageLimits||(t.PageLimits={}))[n.CarsLimit=7]="CarsLimit",n[n.WinnersLimit=10]="WinnersLimit"},7109:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.RequestStatuses=void 0,(n=t.RequestStatuses||(t.RequestStatuses={}))[n.Success=200]="Success",n[n.ServerError=500]="ServerError",n[n.NotFound=404]="NotFound"},4921:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CarCell=void 0;const a=n(4003),r=n(3730),s=n(7109),i=n(6132),o=n(6349),c=n(4150),l=n(5121),u=n(8785);class d extends u.BaseComponent{carData;car;road=null;carName=new u.BaseComponent({tag:"h4",parent:this.element,attribute:{className:"car-cell__name"}});deleteButton=new u.BaseComponent({tag:"button",parent:this.element,attribute:{className:"car-cell__button",textContent:"delete"}});slectButton=new u.BaseComponent({tag:"button",parent:this.element,attribute:{className:"car-cell__button",textContent:"select"}});carControls=new u.BaseComponent({tag:"div",parent:this.element,attribute:{className:"car-cell__controls"}});driveButton=new u.BaseComponent({tag:"button",parent:this.carControls.element,attribute:{className:"car-cell__button",textContent:"A"}});stopButton=new u.BaseComponent({tag:"button",parent:this.carControls.element,attribute:{className:"car-cell__button",textContent:"B"}});flag=new u.BaseComponent({tag:"div",parent:this.element,attribute:{className:"car-cell__flag"}});constructor(e,t){super({tag:"div",parent:e,attribute:{className:"car-cell"}}),this.carData=t,this.car=new l.Car(this.element,t),this.setCarName(),this.renderRoad(),this.driveButton.element.addEventListener("click",(()=>this.startDrive())),this.stopButton.element.addEventListener("click",(()=>this.stopDrive())),this.slectButton.element.addEventListener("click",(()=>{i.gameState.modifyingCarId=this.carData.id})),this.deleteButton.element.addEventListener("click",(()=>this.deleteCar()))}async startDrive(){if(this.car.isDriving||!this.road||this.car.passedPath)return;this.car.isDriving=!0,this.car.areBrakesAktivated=!1;const e=this.road.element.offsetWidth-r.distanceFromEndToFlag,{engineStartedData:t,driveModeResponse:n}=await a.httpFetcherGarage.startEngine(this.carData.id),[l,u]=this.makeCalculations(e,t);this.car.startDrive(l,e),(await n).status!==s.RequestStatuses.ServerError?i.gameState.isRaceGoing&&this.checkIsWinner()&&(i.gameState.raceWinnerTime=u,i.gameState.raceWinner=this.car,(0,c.saveWinner)(),o.emitter.emit("show popup",`${this.carData.name} is the winner! Time: ${(u/1e3).toFixed(2)} seconds`)):this.car.isDriving=!1}checkIsWinner(){return!i.gameState.raceWinner}async stopDrive(){0!==this.car.passedPath&&(this.car.isDriving?(await a.httpFetcherGarage.stopEngine(this.carData.id)).status===s.RequestStatuses.Success&&(this.car.isDriving=!1,this.car.areBrakesAktivated=!0):this.car.passedPath=0)}makeCalculations(e,t){const n=Math.round(t.distance/t.velocity);return[e/(n/10),n]}setCarName(){Object.assign(this.carName.element,{textContent:this.carData.name})}renderRoad(){this.road=new u.BaseComponent({tag:"div",parent:this.element,attribute:{className:"car-cell__road"}})}async deleteCar(){await a.httpFetcherGarage.deleteCar(this.carData.id),o.emitter.emit("render cars"),o.emitter.emit("render winners")}}t.CarCell=d},3271:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateCarInput=void 0;const a=n(2308),r=n(6349),s=n(9643);class i extends s.CarInput{constructor(e,t){super(e,t),this.submitButton.element.addEventListener("click",(()=>this.submitHandler()))}submitHandler(){const e={name:this.nameInput.inputValue||"default name",color:this.colorInput.inputValue};(0,a.createCar)(e).then((()=>{r.emitter.emit("render cars")}))}}t.CreateCarInput=i},5120:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GarageControl=void 0;const a=n(8785),r=n(1047),s=n(2308),i=n(6349),o=n(6132),c=n(4657),l=n(3271);class u extends a.BaseComponent{container=new a.BaseComponent({tag:"div",parent:this.element,attribute:{className:"garage-control__container"}});createCar=new l.CreateCarInput(this.container.element,"create");modifyCar=new c.ModifyCarInput(this.container.element,"modify");controlButtons=new a.BaseComponent({tag:"div",parent:this.container.element,attribute:{className:"garage-control__controls-wrapper"}});startRace=new a.BaseComponent({tag:"button",parent:this.controlButtons.element,attribute:{className:"garage-control__button",textContent:"race"}});resetRace=new a.BaseComponent({tag:"button",parent:this.controlButtons.element,attribute:{className:"garage-control__button",textContent:"reset"}});generateCars=new a.BaseComponent({tag:"button",parent:this.controlButtons.element,attribute:{className:"garage-control__button",textContent:"generate"}});constructor(e){super({tag:"div",parent:e,attribute:{className:"garage-control"}}),this.resetRace.element.addEventListener("click",(()=>{const e=o.gameState.carCells?.map((e=>e.stopDrive()));e&&Promise.all(e).then((()=>{o.gameState.isRaceGoing=!1,i.emitter.emit("render cars")}))})),this.generateCars.element.addEventListener("click",(()=>this.generateMoreCars())),this.startRace.element.addEventListener("click",(()=>i.emitter.emit("start race")))}generateMoreCars(){this.generateRandomData().forEach((e=>{(0,s.createCar)(e).then((()=>{i.emitter.emit("render cars")}))}))}generateRandomData(){const{names:e,colors:t}=r.carsDummyData;return Array.from({length:100},(()=>({name:e[Math.floor(Math.random()*e.length)],color:t[Math.floor(Math.random()*t.length)]})))}}t.GarageControl=u},4657:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ModifyCarInput=void 0;const a=n(6132),r=n(4003),s=n(6349),i=n(9643);class o extends i.CarInput{constructor(e,t){super(e,t),this.submitButton.element.addEventListener("click",(()=>this.modifyCar()))}async modifyCar(){if(!a.gameState.modifyingCarId)return;if(!a.gameState.carCells)return;const e=a.gameState.carCells.find((e=>e.carData?.id===a.gameState.modifyingCarId));if(e){const t=e.carData.name;await r.httpFetcherGarage.modifyCar(e.carData.id,{name:this.nameInput.inputValue||t,color:this.colorInput.inputValue??"#000000"}),s.emitter.emit("render cars"),s.emitter.emit("render winners")}}}t.ModifyCarInput=o},1047:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.carsDummyData=void 0,t.carsDummyData={names:["Tesla Model 3","Ford Focus","Honda Civic","Chevrolet Corvette","BMW M4","Audi A4","Toyota Camry","Nissan Altima","Jeep Wrangler","Lexus RX"],colors:["#1A4C8B","#B9D3EE","#FFA500","#800080","#008000","#FF6347","#FF00FF","#DA70D6","#0000FF","#FF0000"]}},3730:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.distanceFromEndToFlag=void 0,t.distanceFromEndToFlag=65},1774:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Garage=void 0;const a=n(8785),r=n(4003),s=n(6349),i=n(6132),o=n(4921),c=n(6613),l=n(5120);class u extends a.BaseComponent{carsData=null;carCells=null;heading=new a.BaseComponent({tag:"h2",parent:this.element,attribute:{className:"garage__heading",textContent:"Garage"}});carCreator=new l.GarageControl(this.element);carsWrapper=new a.BaseComponent({tag:"div",parent:this.element,attribute:{className:"garage__cars-wrapper"}});pagination=new c.Pagination(this.element,(e=>this.paginationHandler(e)));constructor(){super({tag:"div",attribute:{className:"garage"}}),s.emitter.subscribe("render cars",(()=>this.renderCars())),s.emitter.subscribe("start race",(()=>this.startRace())),this.renderCars()}startRace(){this.carCells&&1!==this.carCells.length&&!this.carCells.some((e=>0!==e.car.passedPath))?(i.gameState.isRaceGoing=!0,i.gameState.raceWinner=null,i.gameState.raceWinnerTime=0,this.carCells.forEach((e=>{e.startDrive()}))):s.emitter.emit("show popup","Sorry, there should be more than 1 car to start the race. Also all cars should be on the start line")}paginationHandler(e){if("next"===e)return i.gameState.currentGaragePage+=1,void this.renderCars();1!==i.gameState.currentGaragePage&&(i.gameState.currentGaragePage-=1,this.renderCars())}renderCars(){r.httpFetcherGarage.getCars({isPaginationRequiered:!0}).then((e=>{e.length?(this.carsWrapper.element.replaceChildren(),this.changeGarageCount(),this.carsData=e,this.carCells=this.carsData.map((e=>new o.CarCell(this.carsWrapper.element,e))),i.gameState.carCells=this.carCells):i.gameState.currentGaragePage-=1}))}changeGarageCount(){r.httpFetcherGarage.getCars({isPaginationRequiered:!1}).then((e=>{Object.assign(this.heading.element,{textContent:`Garage (${e.length} cars, currently on page ${i.gameState.currentGaragePage})`})}))}}t.Garage=u},4003:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.httpFetcherGarage=void 0;const a=n(4362),r=n(3428),s=n(6306),i=n(6132),o=n(1761);t.httpFetcherGarage=new class{async getCars({isPaginationRequiered:e=!0}){const t=`?_page=${i.gameState.currentGaragePage}&_limit=${r.API.CarLimit}`,n=await fetch(`${r.API.Path}/garage${e?t:""}`);return await n.json()}async getCar(e){const t=await fetch(`${r.API.Path}/garage/${e}`);return await t.json()}async startEngine(e){const t=await fetch(`${r.API.Path}/engine?id=${e}&status=started`,{method:s.HTTPMethods.PATCH});return{engineStartedData:await t.json(),driveModeResponse:this.startDriveMode(e)}}async startDriveMode(e){return await fetch(`${r.API.Path}/engine?id=${e}&status=drive`,{method:s.HTTPMethods.PATCH})}async stopEngine(e){return await fetch(`${r.API.Path}/engine?id=${e}&status=stopped`,{method:s.HTTPMethods.PATCH})}async createCar(e){const t=JSON.stringify(e);return await fetch(`${r.API.Path}/garage`,{method:s.HTTPMethods.POST,body:t,headers:a.headersForPostMethod})}async deleteCar(e){await fetch(`${r.API.Path}/garage/${e}`,{method:s.HTTPMethods.DELETE}),await o.httpFetcherWinners.deleteWinner(e)}async modifyCar(e,t){const n=JSON.stringify(t);await fetch(`${r.API.Path}/garage/${e}`,{method:s.HTTPMethods.PUT,headers:a.headersForPostMethod,body:n})}}},998:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bringCarBackToStart=void 0,t.bringCarBackToStart=e=>{setTimeout((()=>{Object.assign(e,{passedPath:0})}),11)}},43:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildSvgSprite=void 0,t.buildSvgSprite=function(e,t){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.classList.add("icon");const a=document.createElementNS("http://www.w3.org/2000/svg","use");return a.setAttribute("href",`${t}`),a.classList.add("icon-use"),n.appendChild(a),e.appendChild(n),n}},9643:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CarInput=void 0;const a=n(8785);class r extends a.BaseComponent{nameInput=new a.BaseComponent({tag:"input",parent:this.element,attribute:{className:"car-input__name"}});colorInput=new a.BaseComponent({tag:"input",parent:this.element,attribute:{className:"car-input__color"}});submitButton=new a.BaseComponent({tag:"button",parent:this.element,attribute:{className:"car-input__btn"}});constructor(e,t){super({tag:"div",parent:e,attribute:{className:"car-input"}}),this.nameInput.element.setAttribute("type","text"),this.colorInput.element.setAttribute("type","color"),Object.assign(this.submitButton.element,{textContent:t})}}t.CarInput=r},5121:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Car=void 0;const a=n(8785),r=n(4003),s=n(998),i=n(43),o=n(6132),c=n(6349);class l extends a.BaseComponent{isDriving=!1;areBrakesAktivated=!1;carData;carModel=(0,i.buildSvgSprite)(this.element,"./icons/car.svg#car");constructor(e,t){super({tag:"div",parent:e,attribute:{className:"car-cell__car car"}}),this.carData=t,this.carModel.style.fill=this.carData.color}get passedPath(){const e=getComputedStyle(this.carModel).marginLeft;return Number(e.slice(0,e.length-2))}set passedPath(e){this.carModel.style.marginLeft=`${e}px`}startDrive(e,t){let n=e;const a=setInterval((()=>{this.isDriving||(clearInterval(a),this.isRaceOver()&&this.stopRace()),this.areBrakesAktivated&&(0,s.bringCarBackToStart)(this),this.passedPath=n,n+=e,n>t&&(this.isDriving=!1,r.httpFetcherGarage.stopEngine(this.carData.id))}),10)}stopRace(){o.gameState.isRaceGoing=!1,c.emitter.emit("show popup","race is finished!")}isRaceOver(){return!!o.gameState.isRaceGoing&&!this.isAnyoneStillDriving()}isAnyoneStillDriving(){return!!o.gameState.carCells&&o.gameState.carCells.some((e=>e.car.isDriving))}}t.Car=l},6613:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Pagination=void 0;const a=n(8785);class r extends a.BaseComponent{paginationPreviousButton=new a.BaseComponent({tag:"button",parent:this.element,attribute:{className:"pagination__button",textContent:"before"}});paginationNextButton=new a.BaseComponent({tag:"button",parent:this.element,attribute:{className:"pagination__button",textContent:"next"}});constructor(e,t){super({tag:"div",parent:e,attribute:{className:"pagination"}}),this.paginationPreviousButton.element.addEventListener("click",(()=>t("previous"))),this.paginationNextButton.element.addEventListener("click",(()=>t("next")))}}t.Pagination=r},8785:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseComponent=void 0,t.BaseComponent=class{element;constructor({tag:e="div",parent:t,attribute:n}){this.element=document.createElement(e),t&&t.append(this.element),n&&Object.assign(this.element,n)}get inputValue(){return this.element instanceof HTMLInputElement||this.element instanceof HTMLSelectElement?this.element.value:""}set inputValue(e){(this.element instanceof HTMLInputElement||this.element instanceof HTMLSelectElement)&&(this.element.value=e)}}},2308:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createCar=void 0;const a=n(4003);t.createCar=async e=>await a.httpFetcherGarage.createCar(e)},6349:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.emitter=void 0,t.emitter=new class{events=new Map;subscribe(e,t){let n=this.events.get(e);n||this.events.set(e,n=[]),n.push(t)}unsubscribe(e,t){if(!t)return this.events.delete(e);const n=this.events.get(e);if(!n)return!1;const a=n.indexOf(t);return!(a<0||(n.splice(a,1),0===n.length&&this.events.delete(e),0))}emit(e,t){const n=this.events.get(e);return!!n&&(n.forEach((e=>{try{e(t)}catch(e){console.error(e)}})),!0)}}},6132:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.gameState=void 0,t.gameState=new class{modifyingCarId=null;currentGaragePage=1;carCells=null;isRaceGoing=!1;raceWinner=null;raceWinnerTime=0;currentWinnersPage=1;queryParams=null}},4655:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0,t.Router=class{lastHashPath=null;routerElement;routes;pathNotFound="#not-found";constructor(e,t){this.routes=e,this.routerElement=t,window.addEventListener("hashchange",(()=>this.hashChangeHandler())),this.hashChangeHandler()}hashChangeHandler(){const{hash:e}=window.location;if(this.lastHashPath===e)return;const t=this.routes[e]??this.routes[this.pathNotFound];this.routerElement.replaceChildren(t.element),this.lastHashPath=e}}},4150:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveWinner=void 0;const a=n(7109),r=n(6349),s=n(6132),i=n(1761);t.saveWinner=async()=>{const e=s.gameState.raceWinner?.carData.id;if(!e)return;const t=Number((s.gameState.raceWinnerTime/1e3).toFixed(2));if((await i.httpFetcherWinners.getWinner(e)).status===a.RequestStatuses.NotFound)return await i.httpFetcherWinners.setNewWinner(e,t),void r.emitter.emit("render winners");await i.httpFetcherWinners.updateWinnerData(e,t),r.emitter.emit("render winners")}},828:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WinnerCell=void 0;const a=n(8785),r=n(5121);class s extends a.BaseComponent{data;winnerCarModel;winnerCellElements;cellNumber;cellNumberElement=new a.BaseComponent({tag:"p",parent:this.element,attribute:{className:"winner-cell__data"}});winnerid=new a.BaseComponent({tag:"p",parent:this.element,attribute:{className:"winner-cell__data"}});winnerName=new a.BaseComponent({tag:"p",parent:this.element,attribute:{className:"winner-cell__data"}});winsCount=new a.BaseComponent({tag:"p",parent:this.element,attribute:{className:"winner-cell__data"}});bestTime=new a.BaseComponent({tag:"p",parent:this.element,attribute:{className:"winner-cell__data"}});constructor(e,t,n){super({tag:"div",parent:t,attribute:{className:"winner-cell"}}),this.data=e,this.cellNumber=n;const{id:a,name:s,color:i}=this.data;this.winnerCarModel=new r.Car(this.element,{id:a,name:s,color:i}),this.winnerCellElements=[this.winnerName,this.winnerid,this.winsCount,this.bestTime],this.setData()}setData(){if(!this.data)return;this.cellNumberElement.element.textContent=`${this.cellNumber}`;const{name:e,id:t,wins:n,time:a}=this.data;Array.from([e,t,n,a]).forEach(((e,t)=>{Object.assign(this.winnerCellElements[t].element,{textContent:e})}))}}t.WinnerCell=s},5695:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WinnersControls=void 0;const a=n(8785),r=n(6349);class s extends a.BaseComponent{sortingTypeLabel=new a.BaseComponent({tag:"p",parent:this.element,attribute:{className:"winners-controls__label",textContent:"Sort by:"}});sortingTypeInput=new a.BaseComponent({tag:"select",parent:this.element,attribute:{className:"winners-controls__input"}});sortingOrderLabel=new a.BaseComponent({tag:"p",parent:this.element,attribute:{className:"winners-controls__label",textContent:"order:"}});sortingOrderInput=new a.BaseComponent({tag:"select",parent:this.element,attribute:{className:"winners-controls__input"}});submitButton=new a.BaseComponent({tag:"button",parent:this.element,attribute:{className:"winners-controls__button",textContent:"submit"}});constructor(e){super({tag:"div",parent:e,attribute:{className:"winners-controls"}}),this.setSelectOptions(),this.submitButton.element.addEventListener("click",(()=>this.submitHandler()))}submitHandler(){const e=this.sortingTypeInput.inputValue,t=this.sortingOrderInput.inputValue;r.emitter.emit("render winners",{sort:e,order:t})}setSelectOptions(){["time","wins","id"].map((e=>new a.BaseComponent({tag:"option",parent:this.sortingTypeInput.element,attribute:{textContent:e}}))),[{textContent:"ascending",value:"ASC"},{textContent:"descending",value:"DESC"}].map((({textContent:e,value:t})=>new a.BaseComponent({tag:"option",parent:this.sortingOrderInput.element,attribute:{textContent:e,value:t}})))}}t.WinnersControls=s},9947:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WinnersLeaderBoard=void 0;const a=n(8785),r=n(4003),s=n(6283),i=n(3234),o=n(6132),c=n(828);class l extends a.BaseComponent{winnerElements=[];combinedWinnersData=[];constructor(e){super({tag:"div",parent:e,attribute:{className:"winners-leader-board"}})}async renderWinners(e){this.element.replaceChildren(),this.setTableHeaders(),await this.setData(e),this.winnerElements=this.combinedWinnersData.map(((e,t)=>{const n=(o.gameState.currentWinnersPage-1)*i.PageLimits.WinnersLimit+t+1;return new c.WinnerCell(e,this.element,n)}))}async setData(e){const t=e.map((e=>r.httpFetcherGarage.getCar(e.id))),n=await Promise.all(t);this.combinedWinnersData=e.map(((e,t)=>Object.assign(e,n[t])))}setTableHeaders(){const e=new a.BaseComponent({tag:"div",parent:this.element,attribute:{className:"winners-leader-board__headers-row headers-row"}});s.winnerTableHeaders.forEach((t=>new a.BaseComponent({tag:"div",parent:e.element,attribute:{className:"headers-row__header",textContent:t}})))}}t.WinnersLeaderBoard=l},6283:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.winnerTableHeaders=void 0,t.winnerTableHeaders=["number","id","name","win count","best time","car model"]},1761:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.httpFetcherWinners=void 0;const a=n(3428),r=n(6306),s=n(4362),i=n(3234),o=n(6132);t.httpFetcherWinners=new class{async getWinner(e){return await fetch(`${a.API.Path}/winners/${e}`)}async getWinners(e=!1,t){let n="";return e&&(n=`?_page=${o.gameState.currentWinnersPage}&_limit=${i.PageLimits.WinnersLimit}`),t&&(n+=`&_sort=${t.sort}&_order=${t.order}`),(await fetch(`${a.API.Path}/winners${n}`)).json()}async deleteWinner(e){await fetch(`${a.API.Path}/winners/${e}`,{method:r.HTTPMethods.DELETE})}async updateWinnerData(e,t){const n=await fetch(`${a.API.Path}/winners/${e}`),i=await n.json();let{wins:o,time:c}=i;return o+=1,c=c>t?t:c,await fetch(`${a.API.Path}/winners/${e}`,{method:r.HTTPMethods.PUT,headers:s.headersForPostMethod,body:JSON.stringify({wins:o,time:c})})}async setNewWinner(e,t){return await fetch(`${a.API.Path}/winners`,{method:r.HTTPMethods.POST,headers:s.headersForPostMethod,body:JSON.stringify({id:e,wins:1,time:t})})}}},4872:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Winners=void 0;const a=n(8785),r=n(6132),s=n(6349),i=n(9947),o=n(6613),c=n(5695),l=n(1761);class u extends a.BaseComponent{heading=new a.BaseComponent({tag:"h2",parent:this.element,attribute:{className:"winners__heading"}});controls=new c.WinnersControls(this.element);winnersLeaderBoard=new i.WinnersLeaderBoard(this.element);pagination=new o.Pagination(this.element,(e=>this.pagintationHandler(e)));constructor(){super({tag:"div",attribute:{className:"winners"}}),s.emitter.subscribe("render winners",(e=>this.renderWinners(e))),this.renderWinners()}pagintationHandler(e){if("next"===e)return r.gameState.currentWinnersPage+=1,void this.renderWinners();1!==r.gameState.currentWinnersPage&&(r.gameState.currentWinnersPage-=1,this.renderWinners())}async renderWinners(e){e&&(r.gameState.queryParams=e);const t=await l.httpFetcherWinners.getWinners(),n=await l.httpFetcherWinners.getWinners(!0,r.gameState.queryParams??void 0);n.length?(Object.assign(this.heading.element,{textContent:`Winners (${t.length} cars recorded, currently on page ${r.gameState.currentWinnersPage})`}),this.winnersLeaderBoard.renderWinners(n)):r.gameState.currentWinnersPage-=1}}t.Winners=u},1064:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMCIgaGVpZ2h0PSIwIiBjbGFzcz0iaGlkZGVuIj4KICA8c3ltYm9sIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI1NiAyNTYiIHhtbDpzcGFjZT0icHJlc2VydmUiIHZpZXdCb3g9IjAgMCAyNTYgMjU2IiBpZD0iY2FyIj4KICAgIDxtZXRhZGF0YT5TdmcgVmVjdG9yIEljb25zIDogaHR0cDovL3d3dy5vbmxpbmV3ZWJmb250cy5jb20vaWNvbjwvbWV0YWRhdGE+CiAgICA8Zz4KICAgICAgPGc+CiAgICAgICAgPHBhdGggZD0iTTE3Mi41LDE2OC4xYzAsMTIuMSw5LjgsMjEuOSwyMS45LDIxLjlzMjEuOS05LjgsMjEuOS0yMS45YzAtMTIuMS05LjgtMjEuOS0yMS45LTIxLjlDMTgyLjMsMTQ2LjEsMTcyLjUsMTU2LDE3Mi41LDE2OC4xeiBNMTc5LjcsMTY4LjFjMC04LjIsNi42LTE0LjgsMTQuOC0xNC44czE0LjgsNi42LDE0LjgsMTQuOGMwLDguMS02LjYsMTQuOC0xNC44LDE0LjhTMTc5LjcsMTc2LjIsMTc5LjcsMTY4LjF6IE0yOS42LDE2OC4xYzAsMTIuMSw5LjgsMjEuOSwyMS45LDIxLjljMTIuMSwwLDIxLjktOS44LDIxLjktMjEuOWMwLTEyLjEtOS44LTIxLjktMjEuOS0yMS45QzM5LjQsMTQ2LjEsMjkuNiwxNTYsMjkuNiwxNjguMXogTTM2LjgsMTY4LjFjMC04LjIsNi42LTE0LjgsMTQuOC0xNC44YzguMiwwLDE0LjgsNi42LDE0LjgsMTQuOGMwLDguMS02LjYsMTQuOC0xNC44LDE0LjhDNDMuNCwxODIuOCwzNi44LDE3Ni4yLDM2LjgsMTY4LjF6IE0xMC40LDEyOC4zYy0wLjYsOC43LTAuNCwyMC42LTAuMywyNy42YzAuOSw5LjQsMy44LDEyLjEsMTQuNSwxNS4xYzEuNi0zMCwyNi41LTMzLjEsMzguMS0yNy45YzE3LjMsNy43LDE2LjYsMjcuNywxNi42LDI3LjdoODcuNGMwLDAtMS4zLTE2LDEyLjUtMjUuNmMxMy42LTkuNSw0MS44LTIuNSw0MSwyNS42YzguMSwzLjUsMzMuOC0wLjYsMjMuMy0zOS45Yy00LjQtMTIuNC0xMy03LjgtNDcuNy0xOC4xYy0xNS42LTQuNi0xOC43LTIxLjUtNDQuMi00MS45Yy01LjktNC43LTE3LjctNC45LTI0LjUtNC45Yy01MC0wLjEtNzkuNCwyMS42LTk5LjMsNDRDMTguMywxMTQuNSwxMywxMjEuMSwxMC40LDEyOC4zTDEwLjQsMTI4LjN6IE0yMjYuNSwxNDEuNWMtMC44LTEuMy0wLjYtMy4yLDAtNUgyNDFjMCwwLDIuNSw0LjYtMC4yLDEyLjFDMjM3LjUsMTQ4LjgsMjMyLjYsMTUwLjQsMjI2LjUsMTQxLjVMMjI2LjUsMTQxLjV6IE0xMTMsMTEyLjZWNzZjMCwwLDI1LjctNS45LDMxLjQtMC4yYzUuNyw1LjcsMzAuOSwzMC42LDMxLjMsMzEuNGMwLjQsMC44LDEuOSwzLjUsMCw1LjNIMTEzTDExMywxMTIuNnogTTUwLjQsMTA1LjVjMjMuNS0yMy42LDQ3LjItMjYuOCw0Ny4yLTI2Ljh2MzEuOWwtMS40LDJjMCwwLTQwLjMtMC40LTQzLjUtMC40UzQ4LjcsMTA3LjIsNTAuNCwxMDUuNXogTTEyLjIsMTI5LjhIMjVjLTEuOCw5LjMtOC41LDExLjEtOC41LDExLjFoLTQuM1YxMjkuOHoiPjwvcGF0aD4KICAgICAgPC9nPgogICAgPC9nPgogIDwvc3ltYm9sPgo8L3N2Zz4="},1515:e=>{e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBVcGxvYWRlZCB0bzogU1ZHIFJlcG8sIHd3dy5zdmdyZXBvLmNvbSwgR2VuZXJhdG9yOiBTVkcgUmVwbyBNaXhlciBUb29scyAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgDQoJIHZpZXdCb3g9IjAgMCA1MTEuOTk5IDUxMS45OTkiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPHBhdGggc3R5bGU9ImZpbGw6I0UyMUIxQjsiIGQ9Ik0xMDMuOTE5LDUxLjc0NGMwLDAsNDEuMjk2LDMzLjQ5NiwxMDkuMDA4LDE4LjRjNjQuMi0xNC4yNjQsMTI0LjA1Ni0zMC40NjQsMjI0LjYxNiw1Ljg1NnYyMTUuMDMyDQoJYzAsMC05Mi40ODgtNDQuMTA0LTE3Ni43MzYtMjQuNDMycy0xMzEuODgsMTIuMTItMTU2Ljg4OC0xMi44ODgiLz4NCjxyZWN0IHg9IjkwLjc0IiB5PSIzNy41MjQiIHN0eWxlPSJmaWxsOiM5OTk5OTk7IiB3aWR0aD0iMTYiIGhlaWdodD0iNDc0LjQ3NSIvPg0KPGNpcmNsZSBzdHlsZT0iZmlsbDojNjY2NjY2OyIgY3g9Ijk4Ljc0MSIgY3k9IjI0LjI4NCIgcj0iMjQuMjg0Ii8+DQo8L3N2Zz4="},5763:(e,t,n)=>{e.exports=n.p+"assets/rs-logo.webp"}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var s=t[a]={id:a,exports:{}};return e[a](s,s.exports,n),s.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");if(a.length)for(var r=a.length-1;r>-1&&!e;)e=a[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.b=document.baseURI||self.location.href,n.nc=void 0,n(4273),n(9962)})();